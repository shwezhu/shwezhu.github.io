<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>C Go Java Pythonå†…å­˜ç»“æ„åŠå¯¹æ¯” - David&#39;s Blog</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="David" /><meta name="description" content="å£°æ˜: å¾ˆå¤šçŸ¥è¯†å°¤å…¶æ˜¯GCç›¸å…³ä¹Ÿæ˜¯åˆšæ¥è§¦, é‡Œé¢å¾ˆå¯èƒ½ä¼šæœ‰ä¸æ­£ç¡®çš„è§‚ç‚¹, ä¼šåœ¨æ¥ä¸‹æ¥çš„å­¦ä¹ ä¸­ä¸æ–­çš„ä¿®æ”¹, å½“ä½œè‡ªå·±çš„ç¬”è®°, ç”¨è´¨ç–‘çš„å¿ƒæ€å»è¯»&amp;hell" />






<meta name="generator" content="Hugo 0.111.3 with theme even" />


<link rel="canonical" href="https://shaowenzhu.top/post/other/c-go-java-python-memory-strucutre/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="C Go Java Pythonå†…å­˜ç»“æ„åŠå¯¹æ¯”" />
<meta property="og:description" content="å£°æ˜: å¾ˆå¤šçŸ¥è¯†å°¤å…¶æ˜¯GCç›¸å…³ä¹Ÿæ˜¯åˆšæ¥è§¦, é‡Œé¢å¾ˆå¯èƒ½ä¼šæœ‰ä¸æ­£ç¡®çš„è§‚ç‚¹, ä¼šåœ¨æ¥ä¸‹æ¥çš„å­¦ä¹ ä¸­ä¸æ–­çš„ä¿®æ”¹, å½“ä½œè‡ªå·±çš„ç¬”è®°, ç”¨è´¨ç–‘çš„å¿ƒæ€å»è¯»&hell" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://shaowenzhu.top/post/other/c-go-java-python-memory-strucutre/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2023-05-27T19:59:17+00:00" />
<meta property="article:modified_time" content="2023-05-27T19:59:17+00:00" />
<meta itemprop="name" content="C Go Java Pythonå†…å­˜ç»“æ„åŠå¯¹æ¯”">
<meta itemprop="description" content="å£°æ˜: å¾ˆå¤šçŸ¥è¯†å°¤å…¶æ˜¯GCç›¸å…³ä¹Ÿæ˜¯åˆšæ¥è§¦, é‡Œé¢å¾ˆå¯èƒ½ä¼šæœ‰ä¸æ­£ç¡®çš„è§‚ç‚¹, ä¼šåœ¨æ¥ä¸‹æ¥çš„å­¦ä¹ ä¸­ä¸æ–­çš„ä¿®æ”¹, å½“ä½œè‡ªå·±çš„ç¬”è®°, ç”¨è´¨ç–‘çš„å¿ƒæ€å»è¯»&hell"><meta itemprop="datePublished" content="2023-05-27T19:59:17+00:00" />
<meta itemprop="dateModified" content="2023-05-27T19:59:17+00:00" />
<meta itemprop="wordCount" content="4979">
<meta itemprop="keywords" content="Golang,Java,C,Python," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="C Go Java Pythonå†…å­˜ç»“æ„åŠå¯¹æ¯”"/>
<meta name="twitter:description" content="å£°æ˜: å¾ˆå¤šçŸ¥è¯†å°¤å…¶æ˜¯GCç›¸å…³ä¹Ÿæ˜¯åˆšæ¥è§¦, é‡Œé¢å¾ˆå¯èƒ½ä¼šæœ‰ä¸æ­£ç¡®çš„è§‚ç‚¹, ä¼šåœ¨æ¥ä¸‹æ¥çš„å­¦ä¹ ä¸­ä¸æ–­çš„ä¿®æ”¹, å½“ä½œè‡ªå·±çš„ç¬”è®°, ç”¨è´¨ç–‘çš„å¿ƒæ€å»è¯»&hell"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">David&#39;s Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">David&#39;s Blog</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">C Go Java Pythonå†…å­˜ç»“æ„åŠå¯¹æ¯”</h1>

      <div class="post-meta">
        <span class="post-time"> 2023-05-27 </span>
        <div class="post-category">
            <a href="/categories/other/"> Other </a>
            </div>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#1-c">1. C</a>
          <ul>
            <li><a href="#11-static-memory">1.1. Static Memory</a></li>
            <li><a href="#12-stack-memory">1.2. Stack Memory</a></li>
            <li><a href="#13-heap-memory">1.3. Heap Memory</a></li>
          </ul>
        </li>
        <li><a href="#2-golang">2. Golang</a></li>
        <li><a href="#3-java">3. Java</a></li>
        <li><a href="#4-python">4. Python</a>
          <ul>
            <li><a href="#41-objects-in-python">4.1. Objects in Python</a></li>
            <li><a href="#42-variables-in-python">4.2. Variables in Python</a></li>
          </ul>
        </li>
        <li><a href="#5-pass-by-value-or-reference">5. Pass by Value or Reference</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>å£°æ˜: å¾ˆå¤šçŸ¥è¯†å°¤å…¶æ˜¯GCç›¸å…³ä¹Ÿæ˜¯åˆšæ¥è§¦, é‡Œé¢å¾ˆå¯èƒ½ä¼šæœ‰ä¸æ­£ç¡®çš„è§‚ç‚¹, ä¼šåœ¨æ¥ä¸‹æ¥çš„å­¦ä¹ ä¸­ä¸æ–­çš„ä¿®æ”¹, å½“ä½œè‡ªå·±çš„ç¬”è®°, ç”¨è´¨ç–‘çš„å¿ƒæ€å»è¯»&hellip; è‹±æ–‡éƒ¨åˆ†çš†æ˜¯æ‹·è´çš„å…¶å®ƒæ–‡ç« å’Œå®˜æ–¹æ–‡æ¡£, é“¾æ¥éƒ½åœ¨æ–‡ç« æœ«å°¾,</p>
<h2 id="1-c">1. C</h2>
<p>C has three different pools of memory:</p>
<ul>
<li><strong>static</strong>: global variable storage, permanent for the entire run of the program.</li>
<li><strong>stack</strong>: local variable storage (automatic, continuous memory).</li>
<li><strong>heap</strong>: dynamic storage (large pool of memory, not allocated in contiguous order).</li>
</ul>
<h3 id="11-static-memory">1.1. Static Memory</h3>
<p>Static memory persists throughout the entire life of the program, and is usually used to store things like <em>global</em> variables, or variables created with the static clause. If a variable is declared <em>outside</em> of a function, it is considered global, meaning it is accessible anywhere in the program. Global variables are static, and there is only one copy for the entire program. Inside a function the variable is allocated on the stack. It is also possible to force a variable to be static using the <strong>static</strong> clause. For example, the same variable created inside a function using the static clause would allow it to be stored in static memory.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">static</span> <span class="kt">int</span> <span class="n">theforce</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="12-stack-memory">1.2. Stack Memory</h3>
<p>The <em>stack</em> is used to store variables used on the inside of a function (including the <code>main()</code> function). Itâ€™s a LIFO, â€œ<strong>L</strong>ast-<strong>I</strong>n,-<strong>F</strong>irst-<strong>O</strong>utâ€, structure. Every time a function declares a new variable it is â€œpushedâ€ onto the stack. Then when a function finishes running, all the variables associated with that function on the stack are deleted, and the memory they use is freed up. This leads to the â€œlocalâ€ scope of function variables. The stack is a special region of memory, and automatically managed by the CPU â€“ so you donâ€™t have to allocate or deallocate memory. Stack memory is divided into successive frames where each time a function is called, it allocates itself a fresh stack frame.</p>
<p>Note that there is generally a limit on the size of the stack â€“ which can vary with the operating system (for example OSX currently has a default stack size of 8MB). If a program tries to put too much information on the stack, <strong>stack overflow</strong> will occur. Stack overflow happens when all the memory in the stack has been allocated, and further allocations begin overflowing into other sections of memory. Stack overflow also occurs in situations where recursion is incorrectly used.</p>
<ul>
<li>the stack grows and shrinks as variables are created and destroyed</li>
<li>stack variables only exist whilst the function that created them exists</li>
</ul>
<h3 id="13-heap-memory">1.3. Heap Memory</h3>
<p>The <em>heap</em> is the diametrical opposite of the stack. The <em>heap</em> is a large pool of memory that can be used dynamically â€“ it is also known as the â€œfree storeâ€. This is memory that is not automatically managed â€“ you have to explicitly allocate (using functions such as malloc), and deallocate (e.g. free) the memory. Failure to free the memory when you are finished with it will result in what is known as a <em>memory leak</em> â€“ memory that is still â€œbeing usedâ€, and not available to other processes. Unlike the stack, there are generally no restrictions on the size of the heap (or the variables it creates), other than the physical size of memory in the machine. Variables created on the heap are accessible anywhere in the program.</p>
<p>Oh, and heap memory requires you to use pointers.</p>
<ul>
<li>the heap is managed by the programmer, the ability to modify it is somewhat boundless</li>
<li>in C, variables are allocated and freed using functions like malloc() and free()</li>
<li>the heap is large, and is usually limited by the physical memory available</li>
<li>the heap requires pointers to access it</li>
</ul>
<p>åœ¨è¿™å…ˆè®¨è®ºä¸€ä¸‹Cå’ŒJavaçš„heapå’Œstack, é¦–å…ˆæ˜¯heap:</p>
<p>C ä¸ Javaå¯¹å¾…heapä¸Šå†…å®¹çš„å¤„ç†æ–¹å¼å¯ä»¥è¯´æ˜¯å®Œå…¨ä¸åŒ, å‰è€…å¿…é¡»æ‰‹åŠ¨ç®¡ç†è€Œåè€…å®Œå…¨æ˜¯GCè‡ªåŠ¨æ¸…ç†, ä¸»è¦åŸå› è¿˜æ˜¯ Javaå¼•å…¥äº†GCå¯ä»¥è‡ªåŠ¨ç®¡ç†heapä¸Šå­˜å‚¨çš„å†…å®¹, C çš„å†…å­˜ç»“æ„å¾ˆç®€å•, å †æ ˆå’Œé™æ€, è€ŒJavaé‡Œåˆ™åœ¨heapé‡Œè¡ç”Ÿå‡ºäº†constant pool, method areaç­‰ä¸œè¥¿, å…·ä½“å¯ä»¥å‚è€ƒæˆ‘çš„å¦ä¸€ç¯‡æ–‡ç« : <a href="https://davidzhu.xyz/2023/05/14/Java/Basics/Memory-Structure/">Javaå†…å­˜ç»“æ„</a>, å¼„æ˜ç™½äº†Javaé‡Œçš„æ¦‚å¿µ, è‡ªç„¶å¯ä»¥åŒºåˆ†å¯¹æ¯”C,</p>
<p>ç›¸å¯¹C, Javaä¸ä»…æœ‰ GC è€Œä¸”å¼•å…¥äº† reference çš„æ¦‚å¿µ, æœ‰äººå¯èƒ½ä¼šè¯´ C é‡Œä¸ä¹Ÿæœ‰å¼•ç”¨å—é‚£ä¸ª<code>&amp;</code>, ä¸å¥½æ„æ€é‚£æ˜¯C++çš„,</p>
<p>Javaé‡Œå¯è°“æ˜¯ä¸‡ç‰©çš†å¯¹è±¡, ä¸”å¯¹è±¡ä¸å˜é‡åˆ†ç¦», å³å˜é‡åªæ˜¯æŒ‡å‘å¯¹è±¡çš„ä¸€ä¸ªå¼•ç”¨reference, å˜é‡å­˜å‚¨åœ¨stackä¸Š, æ‰€æœ‰å¯¹è±¡å­˜åœ¨heapä¸Š, æ¯”å¦‚<code>String str = &quot;hello world&quot;</code>ä¸­<code>&quot;hello worl&quot;:</code>å°±æ˜¯ä¸ªå¯¹è±¡, è€Œå˜é‡<code>str</code>åªæ˜¯ä¸ªå¼•ç”¨, å¼•ç”¨åœ¨stackä¸Š, è¿™å°±ä¸Cç±»ä¼¼äº†å³åˆ›å»ºè¯¥å¼•ç”¨çš„å‡½æ•°è¿”å›æ—¶stackä¸Šçš„è¯¥å‡½æ•°çš„stack frameè¢«popå‡ºå», å³å˜é‡<code>str</code>è¢«è‡ªåŠ¨æ¸…ç†, ä½†å¯¹è±¡<code>&quot;hello world&quot;</code>å‘¢? å¯¹è±¡åœ¨heapä¸Š, å‡½æ•°è¿”å›, å‡½æ•°çš„stack frameè¢«æ¸…ç†ä½†heapä¸Šçš„å¯¹è±¡è¿˜æ²¡æœ‰è¢«æ¸…ç†, è¿™ä¸ªæ—¶å€™å°±æ˜¯GCå‡ºé©¬äº†, å¸¸è§GCä¸€ç§æ–¹æ³•æ˜¯çœ‹å¯¹è±¡çš„å¼•ç”¨è®¡æ•°æ˜¯å¦ä¸ºé›¶, ä½†æ˜¯è¿™ç§åˆå®¹æ˜“å¼•èµ·cyclic referencesçš„é—®é¢˜, æ‰€ä»¥åƒJVM, C#, Ruby, JavaScript, Golangé‡‡ç”¨çš„æ˜¯å¦ä¸€ç§GCå³Mark &amp; Sweep GC, ä½†CPythonçš„GCé‡‡ç”¨çš„ä¸»è¦æ˜¯reference countingæ–¹æ³•, ç”±äºå†…å®¹å¤ªå¤š, å…·ä½“CPythoné‡‡ç”¨æ­¤æ–¹æ³•çš„åŸå› ä»¥åŠå¦‚ä½•è§£å†³circular referenceçš„æ–¹æ³•è¯·å‚è€ƒå®˜æ–¹æ–‡æ¡£: <a href="https://devguide.python.org/internals/garbage-collector/">Garbage Collector Design</a></p>
<blockquote>
<p>Javaé‡Œçš„å˜é‡åˆ†ä¸ºä¸¤ç§: primitive å’Œ reference, å…·ä½“å‚è€ƒ <a href="https://davidzhu.xyz/2023/05/14/Java/Basics/Memory-Structure/">Javaå†…å­˜ç»“æ„</a></p>
<p>ä¸¤ç§GC: Mark &amp; Sweep GC å’Œ Reference counting GC</p>
<p>JVMå¯¹äºå¯¹è±¡çš„å¤„ç†, ä»¥Stringå¯¹è±¡ä¸ºä¾‹: In fact the rules for garbage collecting objects in the string pool are the same as for other String objects: indeed all objects. They will be garbage collected if the GC finds them to be unreachable.</p>
</blockquote>
<p>å¯¹äº stack, Java å’Œ C å…¶å®æ˜¯å‡ ä¹ä¸€æ ·çš„, ä»–ä»¬éƒ½æœ‰stack frameçš„æ¦‚å¿µ, å³æ¯ä¸ªå‡½æ•°å•ç‹¬ä¸€ä¸ªframe, åªåœ¨å¤´éƒ¨è¿›è¡Œpushæˆ–è€…pop, è¿™ä¹Ÿæ˜¯stackæ¯”heapå¿«çš„åŸå› , ä¸éœ€è¦ä»»ä½•çš„look up, é™¤æ­¤ä¹‹å¤–å› ä¸ºstackçš„å†…å­˜æ˜¯è¿ç»­çš„, æˆ‘ä»¬æ¯æ¬¡éƒ½æ˜¯pushåˆ°å…¶å¤´éƒ¨, å°±åƒæ‘ç®±å­, æ‰€ä»¥åœ¨ç¼–è¯‘æœŸå°±éœ€è¦çŸ¥é“å…¶size, ä¸ç„¶æ€ä¹ˆçŸ¥é“ä¸‹ä¸€å—æ”¾åˆ°å†…å­˜çš„å“ªä¸ªåœ°å€å‘¢? è‡³äº thread stack è¿™é‡Œä¸è®¨è®º, ä¹Ÿæš‚æ—¶æ²¡ç ”ç©¶JVMçš„çº¿ç¨‹ç®¡ç†, å¦å¤–è¿˜æœ‰ç›¸å…³è¯é¢˜å³pass by valueè¿˜æ˜¯pass by referenceçš„é—®é¢˜, è¿™é‡Œæˆ‘ä»¬ç•™åœ¨åé¢ä¸Pythonå’ŒGolangä¸€èµ·è®¨è®º, æ¥ä¸‹æ¥çœ‹çœ‹ Golang,</p>
<h2 id="2-golang">2. Golang</h2>
<p>Goçš„å†…å­˜ç»“æ„å°±å¤æ‚äº†, è¿™é‡Œæ³¨æ„å†…å­˜æ¨¡å‹Memory Modelå’Œå†…å­˜ç»“æ„Memory Structure (Memory Management)ä¸æ˜¯ä¸€ä¸ªä¸œè¥¿, è¿™æ˜¯ä¸€ä¸ªå¾ˆé•¿çš„ä»»åŠ¡å•Š, æ˜å¤©å†å†™å§, è¿˜æœ‰ä½œä¸š&hellip;</p>
<p>éœ€è¦å¼ºè°ƒçš„æ˜¯Golangé‡Œæ˜¯æ²¡å¯¹è±¡æ¦‚å¿µçš„, ä¹Ÿä¸å­˜åœ¨Javaå’Œpythoné‡Œçš„é‚£ç§å¼•ç”¨[1], golangé‡Œåªå­˜åœ¨variableå’Œvalue, æ‰€ä»¥è¯´Golangè·ŸCå¾ˆåƒ, ä¸‹é¢<a href="https://go.dev/doc/faq">Goå®˜æ–¹çš„FAQs</a>ä¹Ÿé—´æ¥è¯´å‡ºæ¥Golangçš„å†…å­˜ç»“æ„:</p>
<p><strong>How do I know whether a variable is allocated on the heap or the stack?</strong></p>
<p>From a correctness standpoint, you don&rsquo;t need to know. <strong>Each variable in Go exists as long as there are references to it</strong>. The storage location chosen by the implementation is irrelevant to the semantics of the language.</p>
<p>The storage location does have an effect on writing efficient programs. When possible, the Go compilers will allocate variables that are local to a function in that function&rsquo;s <strong>stack frame</strong>. However, if the compiler cannot prove that the variable is not referenced after the function returns, then the compiler must allocate the variable on the garbage-collected heap to avoid dangling pointer errors. Also, if a local variable is very large, it might make more sense to store it on the heap rather than the stack.</p>
<p>In the current compilers, if a variable has its address taken, that variable is a candidate for allocation on the heap. However, a basic <em>escape analysis</em> recognizes some cases when such variables will not live past the return from the function and can reside on the stack.</p>
<p>å½“ç„¶goé‡Œä¹Ÿæœ‰newå…³é”®å­—, å°±åƒCé‡Œçš„malloc, newåœ¨heapä¸Šåˆ›å»ºstruct, ç„¶åè¿”å›å…¶åœ°å€, è¿™é‡Œä¹Ÿè¦è¯´ä¸€ä¸‹, ä¸çŸ¥é“ä½ å‘ç°æ²¡, heapéƒ½æ˜¯ç”±GCç®¡ç†, stackå³éƒ½æ˜¯çº¿ç¨‹æˆ–è€…å‡½æ•°stack frameæ‰€åœ¨çš„åœ°æ–¹, å½“å‡½æ•°è¿”å›æ—¶è‡ªåŠ¨è¢«æ¸…ç†, å…·ä½“ç»†èŠ‚å…³äºGolangå†…å­˜ç»“æ„, å› ä¸ºå¤ªå¤šäº†, æ‰“ç®—ä¸“é—¨è®°å½•å‡ ç¯‡æ–‡ç« , ä¸åœ¨è¿™è®¨è®ºäº†,</p>
<p>[1]:  Java, Pythonéƒ½æ˜¯å¯¹è±¡åœ¨heap, æŒ‡å‘å¯¹è±¡çš„å˜é‡åˆå«å¼•ç”¨reference, å­˜å‚¨åœ¨stackä¸Š</p>
<h2 id="3-java">3. Java</h2>
<p>è¿™ä¸ªå¥½å†™, ä¹‹å‰ç ”ç©¶è¿‡, ä¸Šé¢ä¹Ÿä¸Cè¿›è¡Œå¯¹æ¯”äº†, æ¯”è¾ƒæ‡’: <a href="https://davidzhu.xyz/2023/05/14/Java/Basics/Memory-Structure/">Javaå†…å­˜ç»“æ„ | æ©˜çŒ«å°å…«çš„é±¼</a></p>
<h2 id="4-python">4. Python</h2>
<h3 id="41-objects-in-python">4.1. Objects in Python</h3>
<p>Everything in Python is an object. <em>Classes</em>, <em>functions</em>, and even simple data types, such as <em>integers</em>, <em>floats</em>, and <em>strings</em>, are objects in Python. When we define an integer in Python, CPython internally creates an object of type <em>integer</em>. These objects are stored in heap memory.</p>
<p>Each Python object consists of three fields:</p>
<ul>
<li>Value</li>
<li>Type</li>
<li>Reference count</li>
</ul>
<p>Let&rsquo;s consider a simple example:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="mi">100</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>When the above code is executed, CPython creates an object of type <code>integer</code> and allocates memory for this object on the heap memory.</p>
<p>The <code>type</code> indicates the type of the object in CPython, and the <code>value</code> field, as the name suggests, stores the value of the object (<code>100</code> in this case). We will discuss the <code>ref_count</code> field later in the article.</p>
<p><img src="a.png" alt="a"></p>
<blockquote>
<p>Memory management in Python involves a <strong>private heap</strong> containing all Python objects and data structures. The management of this private heap is ensured internally by the <em><strong>Python memory manager</strong></em>. &ndash;<a href="https://docs.python.org/3/c-api/memory.html">Memory Management â€” Python 3.11.3 documentation</a></p>
</blockquote>
<p>å¯èƒ½ä½ æ³¨æ„åˆ°äº†, ä¸Šé¢è¯´çš„CPythonæ˜¯ä¸ªå•¥?</p>
<blockquote>
<p><strong>CPython</strong> is the default and most widely used implementation of the Python language. When we say Python, it essentially means we&rsquo;re referring to CPython. When you download Python from <a href="https://www.python.org/">python.org</a>, you basically download the CPython code. Thus, CPython is a program written in C language that implements all the rules and specifications defined by the Python language. CPython can be defined as both an interpreter and a compiler as it compiles Python code into bytecode before interpreting it.</p>
</blockquote>
<p>Since CPython is the reference implementation, all new rules and specifications of the Python language are first implemented by CPython.</p>
<p>In this article, we will discuss the internals of memory management of CPython. Please note: Other implementations, such as <em>Jython</em> and <em>IronPython</em>, may implement memory management in a different way.</p>
<p>As CPython is implemented in the C programming language, letâ€™s first understand two important functions related to memory management in C: <code>malloc</code> and <code>free</code>! è¿™ä¸ªå·²ç»çŸ¥é“æ˜¯å•¥äº†, å°±ä¸æ”¾åˆ°è¿™äº†, åŸæ–‡é“¾æ¥åœ¨ä¸‹é¢,</p>
<h3 id="42-variables-in-python">4.2. Variables in Python</h3>
<p>Variables in Python are just references to the actual object in memory. They are like names or labels that point to the actual object in memory. They do not store any value.</p>
<p>Consider the following example:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">a = 100
</span></span></code></pre></td></tr></table>
</div>
</div><p>As discussed earlier, when the above code is executed, CPython internally creates an object of type <em>integer</em>. The variable <code>a</code> points to this integer object as shown below:</p>
<p><img src="b.png" alt="b"></p>
<p>We can access the integer object in the Python program using the variable <code>a</code>.</p>
<blockquote>
<p>è¯»åˆ°è¿™å¯ä»¥çœ‹å‡ºJavaè¿˜ä¸æ˜¯çœŸæ­£çš„ä¸‡ç‰©çš†å¯¹è±¡(å¦‚æœæƒ³åœ¨heapä¸Šåˆ›å»ºprimitiveå¯¹è±¡ éœ€è¦Integerå£°æ˜åˆ›å»º), ä½†Pythonå°±æ˜¯æ‰€æœ‰çš„ä¸œè¥¿éƒ½æ˜¯å¯¹è±¡, å³ä½¿æ˜¯ä¸€ä¸ªintç±»å‹, ç”šè‡³ä¸€ä¸ªå‡½æ•°ä¹Ÿæ˜¯ä¸ªå¯¹è±¡, å¦å¤–Javaä¸pythonçš„GC(Pythonä¸­ä¸å«GCå«Python memory manager)å¯¹å¯¹è±¡çš„ç®¡ç†æ–¹å¼åŸºæœ¬ä¸Šæ˜¯ä¸€æ ·çš„, å³åˆ†ä¸ºå¼•ç”¨å’Œå¯¹è±¡ä¸¤éƒ¨åˆ†, å¼•ç”¨åœ¨stack, å¯¹è±¡åœ¨heap, ä¸åƒc++é‚£ç§åœ¨å‡½æ•°é‡Œå£°æ˜çš„å°±æ˜¯å±€éƒ¨å¯¹è±¡(ä¸æ˜¯mallocå’Œnew), å¯¹äºJavaä¸pythonæ¥è¯´æ— è®ºä½ åœ¨å“ªåˆ›å»ºä¸€ä¸ªå¯¹è±¡, ä»–ä»¬éƒ½ä¼šè¢«åˆ›å»ºåˆ°heapä¸Š, ä¸”æ ¹æ®å¼•ç”¨è®¡æ•°æ¥åˆ¤æ–­å¯¹è±¡æ˜¯å¦reachable, ç„¶ååˆ¤æ–­æ˜¯å¦å›æ”¶å¯¹è±¡, æ‰€ä»¥ä½ å®Œå…¨å¯ä»¥è¿”å›ä¸€ä¸ªâ€œå±€éƒ¨å¯¹è±¡â€çš„å¼•ç”¨, ä½†C++ä¸­, è‚¯å®šå°±ä¸è¡Œäº†, è¿™ä¼šé€ æˆé‡æŒ‡é’ˆé—®é¢˜,</p>
</blockquote>
<p>Let&rsquo;s assign this integer object to another variable <code>b</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="n">a</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>When the above code is executed, the variables <code>a</code> and <code>b</code> both point to the same integer object, as shown below:</p>
<p><img src="c.png" alt="c"></p>
<p>Let&rsquo;s now increment the value of the integer object by 1:</p>
<p>Let&rsquo;s now increment the value of the integer object by 1:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"># Increment a by 1
</span></span><span class="line"><span class="cl">a = a + 1
</span></span></code></pre></td></tr></table>
</div>
</div><p>When the above code is executed, CPython creates a new integer object with the value <code>101</code> and makes variable <code>a</code> point to this new integer object. Variable <code>b</code> will continue to point to the integer object with the value <code>100</code>, as shown below:</p>
<p><img src="d.png" alt="d"></p>
<p>Here, we can see that instead of overwriting the value of <code>100</code> with <code>101</code>, CPython creates a new object with the value <code>101</code> <strong>because integers in Python are immutable</strong>. Once created, they cannot be modified. Please note that <strong>floats and string data types are also immutable in Python</strong>.</p>
<p>Let&rsquo;s consider a simple Python program to further explain this concept:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The above code defines a simple <code>while</code> loop that increments the value of the variable <code>i</code> until it is less than <code>100</code>. When this code is executed, for every increment of the variable <code>i</code>, CPython will create a new integer object with the incremented value, and the old integer object will be deleted (to be more precise, this object would become eligible for deletion) from memory.</p>
<p>CPython calls the <code>malloc</code> method for each new object to allocate memory for that object. It calls the <code>free</code> method to delete the old object from memory.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># malloc(i)</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># malloc(i + 1)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># free(i)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We can see that CPython creates and deletes a large number of objects, even for this simple program. If we call the <code>malloc</code> and <code>free</code> methods for each object creation and deletion, it will degrade the programâ€™s execution performance and make the program slow.</p>
<p>Hence, CPython introduces various techniques to reduce the number of times we have to call <code>malloc</code> and <code>free</code> for each small object creation and deletion. Letâ€™s now understand how CPython manages memory!</p>
<p>é˜…è¯»æ›´å¤š: <a href="https://www.honeybadger.io/blog/memory-management-in-python/">Memory Management in Python - Honeybadger Developer Blog</a></p>
<h2 id="5-pass-by-value-or-reference">5. Pass by Value or Reference</h2>
<p>å…³äºGolangçš„è®¨è®ºè¯·å‚è€ƒ:<a href="https://davidzhu.xyz/2023/05/16/Golang/Basics/methods-pass-by-value/?highlight=%E5%80%BC%E4%BC%A0%E9%80%92">Golangå€¼ä¼ é€’åˆ†æä¹‹ä¼ é€’æŒ‡é’ˆçš„è§„åˆ™ä»‹ç»(Methods, Functions &amp; interface value) | æ©˜çŒ«å°å…«çš„é±¼</a></p>
<p>Java, Golang, C éƒ½æ˜¯ pass by value, C çš„ä¸å†è®¨è®º, åœ¨è¿™è¯´ä¸€ä¸‹Javaå‡½æ•°ä¼ referenceçš„æ—¶å€™ä¼ çš„æ˜¯referenceçš„å€¼, å³åœ°å€:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">foo</span><span class="o">(</span><span class="n">Person</span> <span class="n">p</span><span class="o">)</span> <span class="o">{...}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// main()
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">Person</span> <span class="n">jack</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Person</span><span class="o">(</span><span class="mi">18</span><span class="o">,</span> <span class="err">â€œ</span><span class="n">jack</span><span class="err">â€</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">foo</span><span class="o">(</span><span class="n">p</span><span class="o">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å˜é‡<code>jack</code>å­˜çš„æ˜¯å¯¹è±¡<code>Person(18, â€œjackâ€)</code>åœ¨heapä¸Šçš„åœ°å€, å‡å…¥æ˜¯<code>0x7D</code>, é‚£å˜é‡<code>p</code>çš„å€¼ä¹Ÿæ˜¯<code>0x7D</code>, å¦‚æœåœ¨å‡½æ•°<code>foo</code>ä¸­æˆ‘ä»¬æ‰§è¡Œå¦‚ä¸‹:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">foo</span><span class="o">(</span><span class="n">Person</span> <span class="n">p</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">p</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="s">&#34;John&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">p</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Person</span><span class="o">(</span><span class="mi">17</span><span class="o">,</span> <span class="s">&#34;AK&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è°ƒç”¨äº†å‡½æ•°<code>foo</code>å, å˜é‡<code>jack</code>çš„å€¼å˜äº†å—? è‚¯å®šæ²¡æœ‰, jackçš„å€¼ä¾ç„¶æ˜¯<code>Person(18, â€œjackâ€)</code>çš„åœ°å€<code>0x7D</code>, è°å˜äº†å‘¢? ç­”æ¡ˆæ˜¯<code>Person(18, â€œjackâ€)</code>, è¯¥å¯¹è±¡çš„nameå±æ€§å˜æˆäº†<code>John</code>, è€Œå˜äº†<code>p</code>åªæ˜¯ä»æœ€åˆçš„åœ°å€å³<code>0x7D</code>å˜æˆäº†å¦ä¸€ä¸ªå¯¹è±¡<code>Person(17, &quot;AK&quot;)</code>çš„åœ°å€,</p>
<p>è™½ç„¶Golangä¹Ÿæ˜¯å€¼ä¼ é€’, ä½†å’ŒJavaè¿˜å¾ˆä¸ä¸€æ ·, Golangçš„è¡¨ç°æ›´åƒC, å› ä¸ºGolangé‡Œæ²¡æœ‰å¯¹è±¡å’Œå¼•ç”¨çš„æ¦‚å¿µ, åªæœ‰å˜é‡å’Œå…¶value, æ‰€ä»¥ä½ ä¼ é€’ä¸€ä¸ªå˜é‡çš„æ—¶å€™, å°±æ˜¯æŠŠé‚£ä¸ªå˜é‡çš„valueå½“å‚æ•°ä¼ é€’, è€Œä¸æ˜¯æ‰€æŒ‡å‘å¯¹è±¡çš„åœ°å€, è‡³äºè¯¥å˜é‡æ˜¯åˆ†é…åœ¨stackä¸Šè¿˜æ˜¯heapä¸Š, åœ¨ä¸Šé¢ä»‹ç»Golangçš„æ—¶å€™æˆ‘ä»¬å·²ç»è¯´è¿‡, ä¸å†èµ˜è¿°,</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">Person</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">name</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="nx">age</span>  <span class="kt">int</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">foo1</span><span class="p">(</span><span class="nx">person</span> <span class="nx">Person</span><span class="p">)</span> <span class="o">*</span><span class="nx">Person</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="o">&amp;</span><span class="nx">person</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">foo2</span><span class="p">(</span><span class="nx">person</span> <span class="o">*</span><span class="nx">Person</span><span class="p">)</span> <span class="o">*</span><span class="nx">Person</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nx">person</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">person</span> <span class="o">:=</span> <span class="nx">Person</span><span class="p">{</span><span class="s">&#34;John&#34;</span><span class="p">,</span> <span class="mi">18</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;main: %p\n&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">person</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;foo1: %p\n&#34;</span><span class="p">,</span> <span class="nf">foo1</span><span class="p">(</span><span class="nx">person</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;foo2: %p\n&#34;</span><span class="p">,</span> <span class="nf">foo2</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">person</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">main</span><span class="p">:</span> <span class="mh">0x14000114018</span>
</span></span><span class="line"><span class="cl"><span class="nx">foo1</span><span class="p">:</span> <span class="mh">0x14000114030</span>
</span></span><span class="line"><span class="cl"><span class="nx">foo2</span><span class="p">:</span> <span class="mh">0x14000114018</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æœ€åçœ‹ä¸€ä¸‹python, å…³äºpythonä¹Ÿå¯ä»¥è®¤ä¸ºæ˜¯pass by value, è¡Œä¸ºå’ŒJavaå®Œå…¨ä¸€æ ·, å³ä¼ é€’çš„éƒ½æ˜¯å¼•ç”¨çš„å€¼(å¯¹è±¡çš„åœ°å€), å†å¼ºè°ƒä¸€éåœ¨pythonæ‰€æœ‰çš„å€¼éƒ½æ˜¯å¯¹è±¡, å˜é‡å°±æ˜¯å¼•ç”¨å³å­˜å‚¨å¯¹è±¡çš„åœ°å€,</p>
<ul>
<li>If you pass a <em>mutable</em> object into a method, the method gets a reference to that same object and you can mutate it to your heart&rsquo;s delight, but if you rebind the reference in the method, the outer scope will know nothing about it, and after you&rsquo;re done, the outer reference will still point at the original object.</li>
<li>If you pass an <em>immutable</em> object to a method, you still can&rsquo;t rebind the outer reference, and you can&rsquo;t even mutate the object.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt;&gt;&gt; def main<span class="o">()</span>:
</span></span><span class="line"><span class="cl">...     <span class="nv">n</span> <span class="o">=</span> <span class="m">9001</span>
</span></span><span class="line"><span class="cl">...     print<span class="o">(</span>f<span class="s2">&#34;Initial address of n: {id(n)}&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">...     increment<span class="o">(</span>n<span class="o">)</span>
</span></span><span class="line"><span class="cl">...     print<span class="o">(</span>f<span class="s2">&#34;  Final address of n: {id(n)}&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; def increment<span class="o">(</span>x<span class="o">)</span>:
</span></span><span class="line"><span class="cl">...     print<span class="o">(</span>f<span class="s2">&#34;Initial address of x: {id(x)}&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">...     <span class="nv">x</span> <span class="o">+=</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl">...     print<span class="o">(</span>f<span class="s2">&#34;  Final address of x: {id(x)}&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; main<span class="o">()</span>
</span></span><span class="line"><span class="cl">Initial address of n: <span class="m">140562586057840</span>
</span></span><span class="line"><span class="cl">Initial address of x: <span class="m">140562586057840</span>
</span></span><span class="line"><span class="cl">Final address of x: <span class="m">140562586057968</span>
</span></span><span class="line"><span class="cl">Final address of n: <span class="m">140562586057840</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æœ€å: å¯¹äºC, C++,è¿™ç§æ²¡æœ‰GCçš„è¯­è¨€çš„å†…å­˜ç»“æ„æˆ‘ä»¬è¦æ¸…æ¥šæ¯ä¸€ä¸ªç»†èŠ‚, ä»€ä¹ˆæ—¶å€™å¯¹è±¡è¢«åˆ é™¤, æ€ä¹ˆåˆ é™¤, åˆ†é…åœ¨äº†å“ª, å¯¹äºæœ‰GCçš„, Golang, Java, Pythonè¿™ç§GCçš„å®ç°, ä¸ç”¨æ±‚äºä¸€ä¸‹ææ˜ç™½(ä¹Ÿæä¸æ˜ç™½), å› ä¸ºè¿™ç§è¯­è¨€ä¸»è¦çš„åœ°æ–¹å°±åœ¨GCçš„è®¾è®¡, GCæœ¬èº«å¾ˆå¤æ‚åŠ ä¸Šæœ¬å¤šä¸åŒçš„ç®—æ³•, å¯ä»¥ç•™ç€æ…¢æ…¢çš„æ‘¸ç´¢æ¢ç´¢, ä¹‹æ‰€ä»¥æœ‰GCçš„è¯­è¨€å¯ä»¥æ…¢æ…¢äº†è§£GCçš„æœºåˆ¶æ˜¯å› ä¸ºå†…å­˜éƒ½æ˜¯GCå¸®æˆ‘ä»¬ç®¡ç†, ç®€å•äº†è§£å†…å­˜ç»“æ„, pass by value or reference, äº†è§£å¯¹è±¡çš„æ¸…é™¤æœºåˆ¶å³ä¸ä¼šé‚£ä¹ˆå®¹æ˜“å†™å‡ºå†…å­˜ç›¸å…³çš„é”™è¯¯, è¿™ä¹Ÿæ˜¯æœ‰GCçš„åŸå› , å¸®æˆ‘ä»¬å‡å°‘å·¥ä½œé‡, ç­‰ä½ ä»¥åæœ‰éœ€æ±‚äº†, è‡ªç„¶å°±ä¼šäº†è§£, å½“ç„¶è¿™åªæ˜¯å¯¹æ–°å…¥é—¨çš„æ¥è¯´, å¦‚æœæœ¬æ¥å¾ˆå‰å®³..</p>
<p>å‚è€ƒ:</p>
<ul>
<li><a href="https://craftofcoding.wordpress.com/2015/12/07/memory-in-c-the-stack-the-heap-and-static/">Memory in C â€“ the stack, the heap, and static â€“ The Craft of Coding</a></li>
<li><a href="https://stackoverflow.com/questions/18406703/when-will-a-string-be-garbage-collected-in-java">When will a string be garbage collected in java - Stack Overflow</a></li>
<li><a href="https://www.baeldung.com/java-choosing-gc-algorithm">Choosing a GC Algorithm in Java | Baeldung</a></li>
<li><a href="https://segment.com/blog/allocation-efficiency-in-high-performance-go-services/">Golang Memory Management: Allocation Efficiency in Go Services</a></li>
<li><a href="https://docs.python.org/3/c-api/memory.html">Memory Management â€” Python 3.11.3 documentation</a></li>
<li><a href="https://www.honeybadger.io/blog/memory-management-in-python/">Memory Management in Python - Honeybadger Developer Blog</a></li>
<li><a href="https://en.wikipedia.org/wiki/CPython">CPython</a></li>
<li><a href="https://deepu.tech/memory-management-in-golang/">ğŸš€ Visualizing memory management in Golang | Technorage</a></li>
<li><a href="https://stackoverflow.com/a/73021/16317008">methods - Is Java &ldquo;pass-by-reference&rdquo; or &ldquo;pass-by-value&rdquo;? - Stack Overflow</a></li>
<li><a href="https://stackoverflow.com/questions/10866195/stack-vs-heap-allocation-of-structs-in-go-and-how-they-relate-to-garbage-collec">Stack vs heap allocation of structs in Go, and how they relate to garbage collection - Stack Overflow</a></li>
<li><a href="https://stackoverflow.com/questions/986006/how-do-i-pass-a-variable-by-reference">python - How do I pass a variable by reference? - Stack Overflow</a></li>
<li><a href="https://devguide.python.org/internals/garbage-collector/">Garbage Collector Design</a></li>
<li><a href="https://deepu.tech/memory-management-in-programming/">ğŸš€ Demystifying memory management in modern programming languages | Technorage</a></li>
</ul>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">David</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">
        2023-05-27
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/golang/">Golang</a>
          <a href="/tags/java/">Java</a>
          <a href="/tags/c/">C</a>
          <a href="/tags/python/">Python</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/cs-basics/006-cpu-architecture/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Hyper-Threading &amp; Physical Threads</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/cs-basics/007-thread-process/">
            <span class="next-text nav-default">å¹¶å‘å­¦ä¹ ä¹‹çº¿ç¨‹å’Œè¿›ç¨‹ (Thread Stack)</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:shwezhu@qq.com" class="iconfont icon-email" title="email"></a>
      <a href="https://twitter.com/shwezhu" class="iconfont icon-twitter" title="twitter"></a>
      <a href="http://localhost:1313" class="iconfont icon-linkedin" title="linkedin"></a>
      <a href="https://github.com/shwezhu" class="iconfont icon-github" title="github"></a>
  <a href="https://shaowenzhu.top/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2023<span class="heart"><i class="iconfont icon-heart"></i></span><span>David</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js"></script>








</body>
</html>
